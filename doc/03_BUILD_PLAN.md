# –ü–ª–∞–Ω —Å–±–æ—Ä–∫–∏ MVP: AI-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫

## Scope

–ê–≥–µ–Ω—Ç –≤ Mattermost, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç Data Contracts —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–ø–∏—Å–∫—É —Å–æ stakeholder'–∞–º–∏. –ë–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞–±–æ—Ä —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö markdown-—Ñ–∞–π–ª–æ–≤.

–°—Ä–æ–∫: 5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Cursor + Claude Code.

---

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] –°–µ—Ä–≤–µ—Ä —Å Docker (Linux) ‚Äî –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
- [ ] –ê–∫–∫–∞—É–Ω—Ç Mattermost —Å –ø—Ä–∞–≤–∞–º–∏ —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
- [ ] API –∫–ª—é—á OpenRouter (openrouter.ai)
- [ ] 3‚Äì5 stakeholder'–æ–≤ –¥–ª—è –ø–∏–ª–æ—Ç–∞

---

## –î–µ–Ω—å 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –ó–∞–¥–∞—á–∞
–°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞, —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

### 1.1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –≤ Mattermost

System Console ‚Üí Integrations ‚Üí Bot Accounts ‚Üí Create Bot
- Display Name: `Data Architect`
- Description: `AI-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫`
- Role: Member
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Bot Access Token

–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª `Data Contracts`. –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞.

–ü–æ–ª—É—á–∏—Ç—å ID:
- Bot User ID: API ‚Üí `GET /api/v4/users/username/{bot_username}`
- Channel ID: API ‚Üí `GET /api/v4/channels/name/{team_id}/{channel_name}`

### 1.2. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

```bash
mkdir -p ai-architect/{src,prompts,context,contracts,drafts,participants,memory,tasks}
cd ai-architect
```

### 1.3. –ù–∞–ø–∏—Å–∞—Ç—å mattermost_client.py

–ó–∞–¥–∞—á–∞ –¥–ª—è Cursor/Claude Code:

```
–ù–∞–ø–∏—à–∏ Python-–º–æ–¥—É–ª—å src/mattermost_client.py.

–ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É mattermostdriver.

–ö–ª–∞—Å—Å MattermostClient:
- __init__(url, token, bot_user_id, channel_id) ‚Äî –∏–∑ env
- connect_websocket(callback) ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket, 
  –≤—ã–∑—ã–≤–∞–µ—Ç callback –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö posted –∏ user_added
- send_to_channel(message, root_id=None) ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –∫–∞–Ω–∞–ª 
  (–µ—Å–ª–∏ root_id ‚Äî –æ—Ç–≤–µ—Ç –≤ —Ç—Ä–µ–¥–µ)
- send_dm(user_id, message) ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- get_user_info(user_id) ‚Äî –ø–æ–ª—É—á–∏—Ç—å username –∏ –∏–º—è
- get_channel_members() ‚Äî —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–∞–Ω–∞–ª–∞
- get_thread(post_id) ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—Ä–µ–¥–∞

Credentials –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
MATTERMOST_URL, MATTERMOST_BOT_TOKEN, 
MATTERMOST_BOT_USER_ID, DATA_CONTRACTS_CHANNEL_ID

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, reconnect –ø—Ä–∏ –æ–±—Ä—ã–≤–µ WebSocket.
```

### 1.4. –ù–∞–ø–∏—Å–∞—Ç—å llm_client.py

–ó–∞–¥–∞—á–∞ –¥–ª—è Cursor/Claude Code:

```
–ù–∞–ø–∏—à–∏ Python-–º–æ–¥—É–ª—å src/llm_client.py.

–ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É openai (OpenRouter —Å–æ–≤–º–µ—Å—Ç–∏–º —Å OpenAI API).

–ö–ª–∞—Å—Å LLMClient:
- __init__(api_key, cheap_model, heavy_model) ‚Äî –∏–∑ env
- call_cheap(system_prompt, user_message) ‚Üí str
  - max_tokens=500, temperature=0.0
  - –î–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞ –∏ –ø—Ä–æ—Å—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- call_heavy(system_prompt, user_message, max_tokens=2000) ‚Üí str
  - temperature=0.3
  - –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

base_url = "https://openrouter.ai/api/v1"

Credentials –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
OPENROUTER_API_KEY, CHEAP_MODEL, HEAVY_MODEL

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –º–æ–¥–µ–ª—å, —Ç–æ–∫–µ–Ω—ã, —Å—Ç–æ–∏–º–æ—Å—Ç—å (–∏–∑ response headers).
Retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö 429 –∏ 5xx.
```

### 1.5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```
–ù–∞–ø–∏—à–∏ —Å–∫—Ä–∏–ø—Ç src/test_connections.py:
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Mattermost, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç –≤ –∫–∞–Ω–∞–ª Data Contracts
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ DM —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–¥ (–æ—Ç–≤–µ—Ç –Ω–∞ —Å–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ)
4. –í—ã–∑–≤–∞—Ç—å cheap model —á–µ—Ä–µ–∑ OpenRouter: "–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º: —Ä–∞–±–æ—Ç–∞–µ—Ç?"
5. –í—ã–∑–≤–∞—Ç—å heavy model: "–°–∫–∞–∂–∏ 'heavy model —Ä–∞–±–æ—Ç–∞–µ—Ç'"
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

### –ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª
- [ ] –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç DM
- [ ] –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç —Ç—Ä–µ–¥—ã
- [ ] Cheap model –æ—Ç–≤–µ—á–∞–µ—Ç —á–µ—Ä–µ–∑ OpenRouter
- [ ] Heavy model –æ—Ç–≤–µ—á–∞–µ—Ç —á–µ—Ä–µ–∑ OpenRouter

---

## –î–µ–Ω—å 2: –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ø—Ä–æ–º–ø—Ç—ã

### –ó–∞–¥–∞—á–∞
–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã.

### 2.1. –ü—Ä–æ–º–ø—Ç—ã

**prompts/system_full.md** ‚Äî —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ 01_SYSTEM_PROMPT.md, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å:
- –ó–∞–º–µ–Ω–∏—Ç—å @–∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π username
- –£—Ç–æ—á–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∫—Ä—É–≥–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ stakeholder'–æ–≤

**prompts/system_short.md** ‚Äî —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è cheap model:
```markdown
–¢—ã ‚Äî AI-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–æ–º–ø–∞–Ω–∏–∏ –ü—Ä–∞–≤–æ–¢–µ—Ö. 
–û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.

–ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç ‚Äî –≤–µ—Ä–Ω–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
–ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç —Å—Ç–∞—Ç—É—Å ‚Äî –≤–µ—Ä–Ω–∏ —Å–ø–∏—Å–æ–∫ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
–ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å –æ—Ç–≤–µ—Ç–∞ ‚Äî —Å–∫–∞–∂–∏ —á–µ—Å—Ç–Ω–æ.

–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–¥—É–º—ã–≤–∞–π –¥–∞–Ω–Ω—ã–µ.
```

**prompts/router.md** ‚Äî –ø—Ä–æ–º–ø—Ç —Ä–æ—É—Ç–µ—Ä–∞ (–∏–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏).

**prompts/reminder_templates.md** ‚Äî —à–∞–±–ª–æ–Ω—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π.

**prompts/digest_template.md**:
```markdown
–°—Ñ–æ—Ä–º–∏—Ä—É–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –¥–ª—è –∫–∞–Ω–∞–ª–∞ Data Contracts.

–î–∞–Ω–Ω—ã–µ:
{contracts_index}
{queue}
{reminders}

–§–æ—Ä–º–∞—Ç:
üìä –î–∞–π–¥–∂–µ—Å—Ç Data Contracts –∑–∞ –Ω–µ–¥–µ–ª—é
‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã: [—Å–ø–∏—Å–æ–∫]
üîÑ –í —Ä–∞–±–æ—Ç–µ: [—Å–ø–∏—Å–æ–∫ + –∫—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç + —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π]
üìã –í –æ—á–µ—Ä–µ–¥–∏: [—Å–ª–µ–¥—É—é—â–∏–µ 3]
–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è: [–ø–ª–∞–Ω]
```

### 2.2. –ö–æ–Ω—Ç–µ–∫—Å—Ç

**context/company.md** ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
- –ü—Ä–æ–¥—É–∫—Ç—ã –∏ —á—Ç–æ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç
- Extra Time –∫–∞–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ä—É—á–∫–∏ (NI + REC)
- –¢–µ–∫—É—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

**context/circles.md** ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å:
- –ö–∞–∂–¥—ã–π –∫—Ä—É–≥: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π (@username), –¥–æ–º–µ–Ω, —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

**context/metrics_tree.md** ‚Äî –¥–µ—Ä–µ–≤–æ –æ—Ç Extra Time –≤–Ω–∏–∑.

### 2.3. –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**tasks/queue.json** ‚Äî –æ—á–µ—Ä–µ–¥—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (3‚Äì5 —à—Ç—É–∫):
```json
{
  "queue": [
    {
      "id": "win_ni",
      "priority": 1,
      "reason": "–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ 27.5 vs 31 –º–ª–Ω",
      "stakeholders": ["@username1", "@username2"],
      "status": "queued"
    }
  ]
}
```

**contracts/index.json** ‚Äî –ø—É—Å—Ç–æ–π —Ä–µ–µ—Å—Ç—Ä:
```json
{"contracts": []}
```

**participants/index.json** ‚Äî –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –ø–∏–ª–æ—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã:
–î–ª—è –∫–∞–∂–¥–æ–≥–æ stakeholder'–∞ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª participants/{username}.md —Å —Å–µ–∫—Ü–∏–µ–π ¬´–ë–∞–∑–æ–≤–æ–µ¬ª (–∏–º—è, –∫—Ä—É–≥, —Ä–æ–ª—å). –û—Å—Ç–∞–ª—å–Ω–æ–µ –∞–≥–µ–Ω—Ç –¥–æ–∑–∞–ø–æ–ª–Ω–∏—Ç.

### –ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –í—Å–µ –ø—Ä–æ–º–ø—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] context/ –∑–∞–ø–æ–ª–Ω–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] –û—á–µ—Ä–µ–¥—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
- [ ] –ü—Ä–æ—Ñ–∏–ª–∏ –ø–∏–ª–æ—Ç–Ω—ã—Ö stakeholder'–æ–≤ —Å–æ–∑–¥–∞–Ω—ã

---

## –î–µ–Ω—å 3: –Ø–¥—Ä–æ –∞–≥–µ–Ω—Ç–∞

### –ó–∞–¥–∞—á–∞
Router + Agent + Listener + Memory. –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è.

### 3.1. memory.py

```
–ù–∞–ø–∏—à–∏ src/memory.py ‚Äî –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏.

–§—É–Ω–∫—Ü–∏–∏:
- read_file(path) ‚Üí str ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª
- write_file(path, content) ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª
- append_jsonl(path, data) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ JSONL
- read_json(path) ‚Üí dict ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å JSON
- write_json(path, data) ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å JSON
- list_contracts() ‚Üí list ‚Äî –∏–∑ contracts/index.json
- get_contract(contract_id) ‚Üí str ‚Äî —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- save_contract(contract_id, content) ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç
- save_draft(contract_id, content) ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥—Ä–∞—Ñ—Ç
- update_discussion(contract_id, summary) ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—é–º–µ
- save_decision(data) ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å –≤ decisions.jsonl
- get_participant(username) ‚Üí str ‚Äî –ø—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
- update_participant(username, content) ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
- get_reminders() ‚Üí list ‚Äî –∏–∑ reminders.json
- save_reminders(reminders) ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å reminders.json
- get_queue() ‚Üí list ‚Äî –∏–∑ queue.json

–ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º ‚Äî –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è DATA_DIR 
(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é /app).
```

### 3.2. router.py

```
–ù–∞–ø–∏—à–∏ src/router.py.

–§—É–Ω–∫—Ü–∏—è route(username, message, channel_type, thread_context) ‚Üí dict

1. –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –∏–∑ prompts/router.md
2. –í—ã–∑—ã–≤–∞–µ—Ç llm_client.call_cheap()
3. –ü–∞—Ä—Å–∏—Ç JSON –∏–∑ –æ—Ç–≤–µ—Ç–∞
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç dict: type, entity, load_files, model

–ï—Å–ª–∏ JSON –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è ‚Äî fallback: type="general_question", 
model="heavy", load_files=[].

–ù–µ –∑–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
```

### 3.3. agent.py

```
–ù–∞–ø–∏—à–∏ src/agent.py.

–ö–ª–∞—Å—Å Agent:
- __init__(llm_client, memory, mattermost_client)

- process_message(username, message, channel_type, 
                  thread_context, post_id) ‚Üí str
  1. –í—ã–∑—ã–≤–∞–µ—Ç router.route()
  2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç prompt (full –∏–ª–∏ short –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç model)
  3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ load_files —á–µ—Ä–µ–∑ memory
  4. –°–æ–±–∏—Ä–∞–µ—Ç system_prompt = prompt + –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
  5. –°–æ–±–∏—Ä–∞–µ—Ç user_message = —Å–æ–æ–±—â–µ–Ω–∏–µ + thread_context
  6. –í—ã–∑—ã–≤–∞–µ—Ç llm_client.call_cheap() –∏–ª–∏ call_heavy()
  7. –ü–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç –Ω–∞:
     - reply_text: —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
     - side_effects: —Ñ–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, –ø—Ä–æ—Ñ–∏–ª–∏, –∏ —Ç.–¥.)
  8. –í—ã–ø–æ–ª–Ω—è–µ—Ç side_effects —á–µ—Ä–µ–∑ memory
  9. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç reply_text

- onboard_participant(user_id, username, display_name)
  1. –°–æ–∑–¥–∞—ë—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω (–±–µ–∑ LLM)
  2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ DM (—à–∞–±–ª–æ–Ω)

Side effects: –∞–≥–µ–Ω—Ç –≤ —Å–≤–æ—ë–º –æ—Ç–≤–µ—Ç–µ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∏—Ç—å –±–ª–æ–∫–∏:
[SAVE_CONTRACT:contract_id]
...content...
[/SAVE_CONTRACT]

[SAVE_DRAFT:contract_id]
...content...
[/SAVE_DRAFT]

[UPDATE_DISCUSSION:contract_id]
...json...
[/UPDATE_DISCUSSION]

[ADD_REMINDER]
...json...
[/ADD_REMINDER]

–ê–≥–µ–Ω—Ç –ø–∞—Ä—Å–∏—Ç —ç—Ç–∏ –±–ª–æ–∫–∏, –≤—ã–ø–æ–ª–Ω—è–µ—Ç, –∏ —É–±–∏—Ä–∞–µ—Ç –∏–∑ reply_text.
```

### 3.4. listener.py

```
–ù–∞–ø–∏—à–∏ src/listener.py.

–§—É–Ω–∫—Ü–∏—è start_listener(agent, mattermost_client):
1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket
2. –ü—Ä–∏ —Å–æ–±—ã—Ç–∏–∏ posted:
   - –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–∞
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç channel_type (–∫–∞–Ω–∞–ª –∏–ª–∏ DM)
   - –ï—Å–ª–∏ –≤ –∫–∞–Ω–∞–ª–µ Data Contracts –∏–ª–∏ DM —Å –±–æ—Ç–æ–º:
     - –ü–æ–ª—É—á–∞–µ—Ç thread_context –µ—Å–ª–∏ —ç—Ç–æ –æ—Ç–≤–µ—Ç –≤ —Ç—Ä–µ–¥–µ
     - –í—ã–∑—ã–≤–∞–µ—Ç agent.process_message()
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç (–≤ —Ç—Ä–µ–¥ –µ—Å–ª–∏ –∏–∑ —Ç—Ä–µ–¥–∞, –≤ DM –µ—Å–ª–∏ –∏–∑ DM)
3. –ü—Ä–∏ —Å–æ–±—ã—Ç–∏–∏ user_added –≤ –∫–∞–Ω–∞–ª–µ Data Contracts:
   - –í—ã–∑—ã–≤–∞–µ—Ç agent.onboard_participant()

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö 
–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.
```

### 3.5. main.py

```
–ù–∞–ø–∏—à–∏ src/main.py ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.

1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç .env —á–µ—Ä–µ–∑ dotenv
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç: LLMClient, MattermostClient, Memory, Agent
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö:
   - listener (WebSocket)
   - scheduler (cron)
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ SIGTERM –¥–ª—è graceful shutdown
```

### 3.6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ: `python src/main.py`

–ù–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É –≤ –∫–∞–Ω–∞–ª:
- ¬´–ü—Ä–∏–≤–µ—Ç¬ª ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å
- ¬´–ü–æ–∫–∞–∂–∏ –≤—Å–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã¬ª ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
- ¬´–ö–∞–∫–æ–π —É –Ω–∞—Å –ø–ª–∞–Ω?¬ª ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –æ—á–µ—Ä–µ–¥—å

–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ª–∏—á–∫—É:
- ¬´–ß—Ç–æ —Ç—ã —É–º–µ–µ—à—å?¬ª ‚Üí –¥–æ–ª–∂–µ–Ω –æ–±—ä—è—Å–Ω–∏—Ç—å

### –ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
- [ ] –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ DM
- [ ] Router –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç (–ª–æ–≥–∏)
- [ ] Cheap model –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] Heavy model –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö
- [ ] –§–∞–π–ª—ã –ø–∞–º—è—Ç–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

---

## –î–µ–Ω—å 4: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

### –ó–∞–¥–∞—á–∞
–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤–æ–µ —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ. –û—Ç–ª–∞–¥–∏—Ç—å –≤–µ—Å—å —Ü–∏–∫–ª.

### 4.1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ

–ù–∞–ø–∏—Å–∞—Ç—å –∞–≥–µ–Ω—Ç—É –≤ –∫–∞–Ω–∞–ª–µ –∏–ª–∏ –≤ DM:
```
–ù–∞—á–Ω–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ Data Contract –¥–ª—è WIN NI. 
–ü—Ä–æ–±–ª–µ–º–∞: —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Ü–∏—Ñ—Ä 27.5 –º–ª–Ω –Ω–∞ –±–æ—Ä–¥–µ CEO vs 31 –º–ª–Ω –≤ –≤—ã–≥—Ä—É–∑–∫–µ.
Stakeholder'—ã: @username1, @username2.
```

–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:
- –°–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–¥ –≤ –∫–∞–Ω–∞–ª–µ Data Contracts
- –û–ø–∏—Å–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É
- –¢–µ–≥–Ω—É—Ç—å stakeholder'–æ–≤
- –ó–∞–¥–∞—Ç—å –ø–µ—Ä–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### 4.2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–∏–∫–ª –æ–±—Å—É–∂–¥–µ–Ω–∏—è

–û—Ç–≤–µ—Ç–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ stakeholder'–∞ (–∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ).
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –ê–≥–µ–Ω—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –æ—Ç–≤–µ—Ç –≤ —Ç—Ä–µ–¥–µ
- –ê–≥–µ–Ω—Ç –∑–∞–¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –ê–≥–µ–Ω—Ç —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤ discussion.jsonl
- –ê–≥–µ–Ω—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è

### 4.3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∂–∏–º

–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ reminders.json –≤—Ä—É—á–Ω—É—é. –ó–∞–ø—É—Å—Ç–∏—Ç—å scheduler –≤—Ä—É—á–Ω—É—é:
```python
from src.scheduler import check_reminders
check_reminders()
```

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –Ω—É–∂–Ω—ã–π —Ç—Ä–µ–¥/DM.

### 4.4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–∫—Å–∞—Ü–∏—é –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Å–µ–Ω—Ç (–¥–≤–∞ stakeholder'–∞ —Å–æ–≥–ª–∞—Å–∏–ª–∏—Å—å). –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ contracts/
- index.json –æ–±–Ω–æ–≤–ª—ë–Ω
- –†–µ—à–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ decisions.jsonl
- –°–æ–æ–±—â–µ–Ω–∏–µ ‚úÖ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ —Ç—Ä–µ–¥–µ

### 4.5. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º ‚Äî –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞—Ç—å:
- system_full.md: –µ—Å–ª–∏ –∞–≥–µ–Ω—Ç —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç –Ω–µ—É–¥–∞—á–Ω–æ
- router.md: –µ—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç
- –®–∞–±–ª–æ–Ω—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π: –µ—Å–ª–∏ —Ç–æ–Ω –Ω–µ —Ç–æ—Ç

### –ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –¢—Ä–µ–¥ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω
- [ ] –ê–≥–µ–Ω—Ç –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã stakeholder'–∞–º
- [ ] –û—Ç–≤–µ—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è
- [ ] –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
- [ ] –ö–æ–Ω—Ç—Ä–∞–∫—Ç —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏
- [ ] –í—Å–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

---

## –î–µ–Ω—å 5: Docker, scheduler, –ø–∏–ª–æ—Ç

### –ó–∞–¥–∞—á–∞
–û–±–µ—Ä–Ω—É—Ç—å –≤ Docker. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

### 5.1. scheduler.py

```
–ù–∞–ø–∏—à–∏ src/scheduler.py.

–ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É schedule.

–§—É–Ω–∫—Ü–∏–∏:
- check_reminders(agent, memory, mattermost_client):
  1. –ß–∏—Ç–∞–µ—Ç reminders –∏–∑ memory
  2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–¥–µ next_reminder < now:
     a. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç escalation_step
     b. –®–∞–≥–∏ 1,3,4: –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —à–∞–±–ª–æ–Ω (–±–µ–∑ LLM)
     c. –®–∞–≥ 2: cheap model –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã
     d. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ mattermost_client
     e. –û–±–Ω–æ–≤–ª—è–µ—Ç reminder (step++, next_reminder)
  3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç reminders

- weekly_digest(agent, memory, mattermost_client):
  1. –ß–∏—Ç–∞–µ—Ç contracts/index.json, queue.json, reminders.json
  2. –í—ã–∑—ã–≤–∞–µ—Ç heavy model —Å digest_template.md
  3. –ü—É–±–ª–∏–∫—É–µ—Ç –≤ –∫–∞–Ω–∞–ª

- start_scheduler(agent, memory, mattermost_client):
  –ó–∞–ø—É—Å–∫–∞–µ—Ç schedule:
  - check_reminders –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
  - weekly_digest –∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É 17:00
  –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª schedule.run_pending()
```

### 5.2. Docker

–ù–∞–ø–∏—Å–∞—Ç—å Dockerfile –∏ docker-compose.yml (–∏–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏).

```bash
docker-compose up -d
docker-compose logs -f agent
```

### 5.3. –ó–∞–ø—É—Å–∫ –ø–∏–ª–æ—Ç–∞

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Å—Ç:**
–ù–∞–ø–∏—Å–∞—Ç—å –≤—Ä—É—á–Ω—É—é (–∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∞–≥–µ–Ω—Ç–∞) –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç –≤ –∫–∞–Ω–∞–ª:
```
–ü—Ä–∏–≤–µ—Ç! –Ø AI-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –º–µ—Ç—Ä–∏–∫.

–ü–æ–º–æ–≥–∞—é –∫–æ–º–∞–Ω–¥–µ –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ –µ–¥–∏–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç—Ä–∏–∫ ‚Äî —á—Ç–æ–±—ã —Ü–∏—Ñ—Ä—ã –∑–Ω–∞—á–∏–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –¥–ª—è –≤—Å–µ—Ö.

–ß—Ç–æ —è —É–º–µ—é:
üìã –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å Data Contract ‚Äî –µ–¥–∏–Ω—É—é —Ñ–æ—Ä–º—É–ª—É –º–µ—Ç—Ä–∏–∫–∏
üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –º–µ—Ç—Ä–∏–∫–∞—Ö –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–µ
üîç –ù–∞–π—Ç–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ

–°–µ–π—á–∞—Å –≤ –æ—á–µ—Ä–µ–¥–∏: [—Å–ø–∏—Å–æ–∫ –∏–∑ queue.json]

–ü–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–∫—É –∏–ª–∏ –æ—Ç–≤–µ—á–∞–π—Ç–µ –≤ —Ç—Ä–µ–¥–∞—Ö –∑–¥–µ—Å—å.
```

**–î–æ–±–∞–≤–∏—Ç—å stakeholder'–æ–≤ –≤ –∫–∞–Ω–∞–ª.** –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–ø–∏—à–µ—Ç –∫–∞–∂–¥–æ–º—É –≤ –ª–∏—á–∫—É.

**–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.**

### 5.4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏:
```bash
docker-compose logs -f agent
```

–ü—Ä–æ–≤–µ—Ä—è—Ç—å:
- –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫
- Router –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç
- Cheap/Heavy —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

### –ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –ê–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- [ ] Scheduler —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –¥–∞–π–¥–∂–µ—Å—Ç)
- [ ] 3‚Äì5 stakeholder'–æ–≤ –≤ –∫–∞–Ω–∞–ª–µ
- [ ] –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø—Ä–æ–π–¥–µ–Ω
- [ ] –ú–∏–Ω–∏–º—É–º 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

---

## –ü–æ—Å–ª–µ MVP: –ø–µ—Ä–≤—ã–µ 2 –Ω–µ–¥–µ–ª–∏

### –ù–µ–¥–µ–ª—è 1
- –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ (—Ü–µ–ª—å: 2‚Äì3 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞)
- –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã
- –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ—Ç stakeholder'–æ–≤
- –§–∏–∫—Å–∏—Ç—å –±–∞–≥–∏

### –ù–µ–¥–µ–ª—è 2
- 3‚Äì5 —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å OpenRouter –∑–∞ 2 –Ω–µ–¥–µ–ª–∏
- –†–µ—à–∏—Ç—å: –ø–æ–¥–∫–ª—é—á–∞—Ç—å PostgreSQL –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –±–µ–∑

---

## –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [ ] Mattermost –±–æ—Ç —Å–æ–∑–¥–∞–Ω
- [ ] –ö–∞–Ω–∞–ª Data Contracts —Å–æ–∑–¥–∞–Ω
- [ ] OpenRouter API –∫–ª—é—á –ø–æ–ª—É—á–µ–Ω
- [ ] –°–µ—Ä–≤–µ—Ä —Å Docker (–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞)

### –§–∞–π–ª—ã
- [ ] .env –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] prompts/ ‚Äî –≤—Å–µ –ø—Ä–æ–º–ø—Ç—ã –≥–æ—Ç–æ–≤—ã
- [ ] context/ ‚Äî –∑–∞–ø–æ–ª–Ω–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] tasks/queue.json ‚Äî –æ—á–µ—Ä–µ–¥—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- [ ] participants/ ‚Äî –ø—Ä–æ—Ñ–∏–ª–∏ –ø–∏–ª–æ—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã

### –ö–æ–¥
- [ ] mattermost_client.py
- [ ] llm_client.py
- [ ] memory.py
- [ ] router.py
- [ ] agent.py
- [ ] listener.py
- [ ] scheduler.py
- [ ] main.py
- [ ] Dockerfile + docker-compose.yml

### –¢–µ—Å—Ç—ã
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ –∫–∞–Ω–∞–ª–µ –∏ –≤ DM
- [ ] Router –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] Cheap/Heavy —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞: –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª
- [ ] –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
- [ ] –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã
- [ ] Docker —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

---

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|---|---|
| Router –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON | Fallback –Ω–∞ general_question + heavy |
| –ê–≥–µ–Ω—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–π | –î–æ–±–∞–≤–∏—Ç—å –≤ prompt: ¬´–ú–∞–∫—Å–∏–º—É–º 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π¬ª |
| –ê–≥–µ–Ω—Ç –∑–∞–¥–∞—ë—Ç >3 –≤–æ–ø—Ä–æ—Å–æ–≤ | –£—Å–∏–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ prompt |
| WebSocket –æ—Ç–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è | Reconnect —Å exponential backoff |
| OpenRouter 429 | Retry —Å backoff –≤ llm_client.py |
| –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–µ –≤ —Ç–æ—Ç —Ç—Ä–µ–¥ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å root_id –≤ mattermost_client |
| –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ scheduler: —É–¥–∞–ª—è—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| Heavy model —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–∞—è | –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –±–æ–ª—å—à–µ –∑–∞–¥–∞—á –Ω–∞ cheap + —à–∞–±–ª–æ–Ω—ã |
| Stakeholder'—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –±–æ—Ç–∞ | –ù–∞—á–∞—Ç—å —Å –ø–æ–ª–µ–∑–Ω–æ–≥–æ (—Å—Ç–∞—Ç—É—Å—ã, —Å–ø–∏—Å–∫–∏), –ø–æ—Ç–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è |
